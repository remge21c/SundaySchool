# Coding Convention & AI Collaboration Guide

> ê³ í’ˆì§ˆ/ìœ ì§€ë³´ìˆ˜/ë³´ì•ˆì„ ìœ„í•œ ì¸ê°„-AI í˜‘ì—… ìš´ì˜ ì§€ì¹¨ì„œì…ë‹ˆë‹¤.

---

## MVP ìº¡ìŠ

| # | í•­ëª© | ë‚´ìš© |
|---|------|------|
| 1 | ëª©í‘œ | ì¢…ì´ êµì ë¶€ì˜ ë¹„íš¨ìœ¨ì„ í•´ê²°í•˜ê³ , í•™ìƒ ì´íƒˆ ì¡°ì§ì„ ì¡°ê¸°ì— ë°œê²¬í•˜ì—¬ ëª©íšŒì  'ê³¨ë“ íƒ€ì„'ì„ í™•ë³´ |
| 2 | í˜ë¥´ì†Œë‚˜ | ë°”ìœ ê¹€êµì‚¬ (35ì„¸, ìœ ë…„ë¶€ ë‹´ì„, ìŠ¤ë§ˆíŠ¸í° ê¸°ë³¸ ì‚¬ìš© ê°€ëŠ¥) |
| 3 | í•µì‹¬ ê¸°ëŠ¥ | FEAT-1: ìŠ¤ë§ˆíŠ¸ ì¶œì„ ì²´í¬ (ëª¨ë°”ì¼ì—ì„œ í„°ì¹˜ í•œ ë²ˆìœ¼ë¡œ ì¶œì„ ì²˜ë¦¬) |
| 4 | ì„±ê³µ ì§€í‘œ (ë…¸ìŠ¤ìŠ¤íƒ€) | ë§¤ì£¼ ì¶œì„ ì²´í¬ë¥¼ í•˜ëŠ” êµì‚¬ ë¹„ìœ¨ **80% ì´ìƒ** |
| 5 | ì…ë ¥ ì§€í‘œ | ì£¼ê°„ í™œì„± ì‚¬ìš©ì ìˆ˜ (WAU), ì¶œì„ ê¸°ë¡ ê±´ìˆ˜, í‰ê·  ì¶œì„ ì²˜ë¦¬ ì‹œê°„ (3ì´ˆ ì´ë‚´) |
| 6 | ë¹„ê¸°ëŠ¥ ìš”êµ¬ | ëª¨ë°”ì¼ì—ì„œ ì¶œì„ ì²´í¬ 3ì´ˆ ì´ë‚´ ì™„ë£Œ, WCAG 2.1 AA ì ‘ê·¼ì„± ì¤€ìˆ˜ |
| 7 | Out-of-scope | ê²Œì´ë¯¸í”¼ì¼€ì´ì…˜, í†µê³„ ë¦¬í¬íŠ¸, í•™ë¶€ëª¨ í¬í„¸, ìë™ ë“±ë°˜ ì‹œìŠ¤í…œ (v2ë¡œ ë³´ë¥˜) |
| 8 | Top ë¦¬ìŠ¤í¬ | êµì‚¬ë“¤ì˜ ë””ì§€í„¸ ê¸°ê¸° ìµìˆ™ë„ ì°¨ì´ |
| 9 | ì™„í™”/ì‹¤í—˜ | ê·¹ë„ë¡œ ë‹¨ìˆœí•œ UI (1~2ë²ˆ í„°ì¹˜ë¡œ ì™„ë£Œ), ì˜¨ë³´ë”© íŠœí† ë¦¬ì–¼ (ì²« ì‚¬ìš© ì‹œ 3ë¶„ ê°€ì´ë“œ) |
| 10 | ë‹¤ìŒ ë‹¨ê³„ | ì†Œê·œëª¨ ë¶€ì„œ(ê³ ë“±ë¶€) íŒŒì¼ëŸ¿ ë„ì…, í•µì‹¬ ê¸°ëŠ¥(ì¶œì„, ì‹¬ë°©) ì•ˆì •í™” |

---

## 1. í•µì‹¬ ì›ì¹™

### 1.1 ì‹ ë¢°í•˜ë˜, ê²€ì¦í•˜ë¼ (Don't Trust, Verify)

AIê°€ ìƒì„±í•œ ì½”ë“œëŠ” ë°˜ë“œì‹œ ê²€ì¦í•´ì•¼ í•©ë‹ˆë‹¤:

- [ ] ì½”ë“œ ë¦¬ë·°: ìƒì„±ëœ ì½”ë“œ ì§ì ‘ í™•ì¸
- [ ] í…ŒìŠ¤íŠ¸ ì‹¤í–‰: ìë™í™” í…ŒìŠ¤íŠ¸ í†µê³¼ í™•ì¸
- [ ] ë³´ì•ˆ ê²€í† : ë¯¼ê° ì •ë³´ ë…¸ì¶œ ì—¬ë¶€ í™•ì¸
- [ ] ë™ì‘ í™•ì¸: ì‹¤ì œë¡œ ì‹¤í–‰í•˜ì—¬ ê¸°ëŒ€ ë™ì‘ í™•ì¸

### 1.2 ìµœì¢… ì±…ì„ì€ ì¸ê°„ì—ê²Œ

- AIëŠ” ë„êµ¬ì´ê³ , ìµœì¢… ê²°ì •ê³¼ ì±…ì„ì€ ê°œë°œìì—ê²Œ ìˆìŠµë‹ˆë‹¤
- ì´í•´í•˜ì§€ ëª»í•˜ëŠ” ì½”ë“œëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤
- ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ë¶€ë¶„ì€ ë°˜ë“œì‹œ ì§ˆë¬¸í•©ë‹ˆë‹¤

---

## 2. í”„ë¡œì íŠ¸ êµ¬ì¡°

### 2.1 ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
sunday-school/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ (auth)/             # ì¸ì¦ ê´€ë ¨ í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ (dashboard)/        # ëŒ€ì‹œë³´ë“œ í˜ì´ì§€
â”‚   â”‚   â””â”€â”€ layout.tsx         # ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ
â”‚   â”œâ”€â”€ components/             # ì¬ì‚¬ìš© ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ ui/                # Shadcn/UI ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ attendance/         # ì¶œì„ ê´€ë ¨ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ student/           # í•™ìƒ ê´€ë ¨ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â””â”€â”€ visitation/        # ì‹¬ë°© ê´€ë ¨ ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ hooks/                  # ì»¤ìŠ¤í…€ í›…
â”‚   â”œâ”€â”€ lib/                    # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
â”‚   â”‚   â”œâ”€â”€ supabase/          # Supabase í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â””â”€â”€ utils/             # í—¬í¼ í•¨ìˆ˜
â”‚   â”œâ”€â”€ stores/                 # Zustand ìŠ¤í† ì–´
â”‚   â”œâ”€â”€ types/                  # TypeScript íƒ€ì…
â”‚   â””â”€â”€ __tests__/              # í…ŒìŠ¤íŠ¸ íŒŒì¼
â”œâ”€â”€ public/                     # ì •ì  íŒŒì¼
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ planning/               # ê¸°íš ë¬¸ì„œ
â”œâ”€â”€ .cursorrules                # Cursor AI ê·œì¹™
â”œâ”€â”€ tailwind.config.ts          # Tailwind ì„¤ì •
â”œâ”€â”€ tsconfig.json               # TypeScript ì„¤ì •
â””â”€â”€ package.json
```

### 2.2 ë„¤ì´ë° ê·œì¹™

| ëŒ€ìƒ | ê·œì¹™ | ì˜ˆì‹œ |
|------|------|------|
| íŒŒì¼ (ì»´í¬ë„ŒíŠ¸) | PascalCase | `AttendanceCard.tsx` |
| íŒŒì¼ (ìœ í‹¸) | camelCase | `formatDate.ts` |
| ì»´í¬ë„ŒíŠ¸ | PascalCase | `AttendanceCard` |
| í•¨ìˆ˜/ë³€ìˆ˜ | camelCase | `getStudentById` |
| ìƒìˆ˜ | UPPER_SNAKE | `MAX_RETRY_COUNT` |
| CSS í´ë˜ìŠ¤ | kebab-case | `attendance-card` |
| íƒ€ì…/ì¸í„°í˜ì´ìŠ¤ | PascalCase | `Student`, `AttendanceLog` |

---

## 3. ì•„í‚¤í…ì²˜ ì›ì¹™

### 3.1 ë¼ˆëŒ€ ë¨¼ì € (Skeleton First)

1. ì „ì²´ êµ¬ì¡°ë¥¼ ë¨¼ì € ì¡ê³ 
2. ë¹ˆ í•¨ìˆ˜/ì»´í¬ë„ŒíŠ¸ë¡œ ìŠ¤ì¼ˆë ˆí†¤ ìƒì„±
3. í•˜ë‚˜ì”© êµ¬í˜„ ì±„ì›Œë‚˜ê°€ê¸°

### 3.2 ì‘ì€ ëª¨ë“ˆë¡œ ë¶„í•´

- í•œ íŒŒì¼ì— 200ì¤„ ì´í•˜ ê¶Œì¥
- í•œ í•¨ìˆ˜ì— 50ì¤„ ì´í•˜ ê¶Œì¥
- í•œ ì»´í¬ë„ŒíŠ¸ì— 100ì¤„ ì´í•˜ ê¶Œì¥

### 3.3 ê´€ì‹¬ì‚¬ ë¶„ë¦¬

| ë ˆì´ì–´ | ì—­í•  | ì˜ˆì‹œ |
|--------|------|------|
| UI | í™”ë©´ í‘œì‹œ | React ì»´í¬ë„ŒíŠ¸ |
| ìƒíƒœ | ë°ì´í„° ê´€ë¦¬ | Zustand ìŠ¤í† ì–´, TanStack Query |
| ì„œë¹„ìŠ¤ | API í†µì‹  | Supabase í´ë¼ì´ì–¸íŠ¸ ë˜í¼ |
| ìœ í‹¸ | ìˆœìˆ˜ í•¨ìˆ˜ | ë‚ ì§œ í¬ë§·, ê²€ì¦ |

---

## 4. AI ì†Œí†µ ì›ì¹™

### 4.1 í•˜ë‚˜ì˜ ì±„íŒ… = í•˜ë‚˜ì˜ ì‘ì—…

- í•œ ë²ˆì— í•˜ë‚˜ì˜ ëª…í™•í•œ ì‘ì—…ë§Œ ìš”ì²­
- ì‘ì—… ì™„ë£Œ í›„ ë‹¤ìŒ ì‘ì—… ì§„í–‰
- ì»¨í…ìŠ¤íŠ¸ê°€ ê¸¸ì–´ì§€ë©´ ìƒˆ ëŒ€í™” ì‹œì‘

### 4.2 ì»¨í…ìŠ¤íŠ¸ ëª…ì‹œ

**ì¢‹ì€ ì˜ˆ:**
> "TASKS ë¬¸ì„œì˜ T2.1ì„ êµ¬í˜„í•´ì£¼ì„¸ìš”.
> Database Designì˜ ATTENDANCE_LOGSë¥¼ ì°¸ì¡°í•˜ê³ ,
> TRDì˜ ê¸°ìˆ  ìŠ¤íƒì„ ë”°ë¼ì£¼ì„¸ìš”.
> Design Systemì˜ ë²„íŠ¼ ìŠ¤íƒ€ì¼ì„ ì ìš©í•´ì£¼ì„¸ìš”."

**ë‚˜ìœ ì˜ˆ:**
> "API ë§Œë“¤ì–´ì¤˜"

### 4.3 ê¸°ì¡´ ì½”ë“œ ì¬ì‚¬ìš©

- ìƒˆë¡œ ë§Œë“¤ê¸° ì „ì— ê¸°ì¡´ ì½”ë“œ í™•ì¸ ìš”ì²­
- ì¤‘ë³µ ì½”ë“œ ë°©ì§€
- ì¼ê´€ì„± ìœ ì§€

### 4.4 í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿

```
## ì‘ì—…
{{ë¬´ì—‡ì„ í•´ì•¼ í•˜ëŠ”ì§€}}

## ì°¸ì¡° ë¬¸ì„œ
- {{ë¬¸ì„œëª…}} ì„¹ì…˜ {{ë²ˆí˜¸}}
- {{íŒŒì¼ ê²½ë¡œ}}

## ì œì•½ ì¡°ê±´
- {{ì§€ì¼œì•¼ í•  ê²ƒ}}
- {{ì‚¬ìš©í•  ê¸°ìˆ }}

## ì˜ˆìƒ ê²°ê³¼
- {{ìƒì„±ë  íŒŒì¼}}
- {{ê¸°ëŒ€ ë™ì‘}}
```

---

## 5. ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

### 5.1 ì ˆëŒ€ ê¸ˆì§€

- [ ] ë¹„ë°€ì •ë³´ í•˜ë“œì½”ë”© ê¸ˆì§€ (API í‚¤, ë¹„ë°€ë²ˆí˜¸, í† í°)
- [ ] .env íŒŒì¼ ì»¤ë°‹ ê¸ˆì§€
- [ ] SQL ì§ì ‘ ë¬¸ìì—´ ì¡°í•© ê¸ˆì§€ (SQL Injection)
- [ ] ì‚¬ìš©ì ì…ë ¥ ê·¸ëŒ€ë¡œ ì¶œë ¥ ê¸ˆì§€ (XSS)

### 5.2 í•„ìˆ˜ ì ìš©

- [ ] ëª¨ë“  ì‚¬ìš©ì ì…ë ¥ ê²€ì¦ (ì„œë²„ ì¸¡ - Supabase RLS)
- [ ] ë¹„ë°€ë²ˆí˜¸ í•´ì‹± (Supabase Auth ìë™ ì²˜ë¦¬)
- [ ] HTTPS ì‚¬ìš© (Vercel ìë™ ì ìš©)
- [ ] CORS ì„¤ì • (Supabase ìë™ ì„¤ì •)
- [ ] ì¸ì¦ëœ ìš”ì²­ë§Œ ë¯¼ê° API ì ‘ê·¼ (RLS ì •ì±…)

### 5.3 í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬

```bash
# .env.example (ì»¤ë°‹ O)
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key

# .env.local (ì»¤ë°‹ X)
NEXT_PUBLIC_SUPABASE_URL=https://real-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=real-anon-key
```

---

## 6. í…ŒìŠ¤íŠ¸ ì›Œí¬í”Œë¡œìš°

### 6.1 ì¦‰ì‹œ ì‹¤í–‰ ê²€ì¦

ì½”ë“œ ì‘ì„± í›„ ë°”ë¡œ í…ŒìŠ¤íŠ¸:

```bash
# í”„ë¡ íŠ¸ì—”ë“œ í…ŒìŠ¤íŠ¸
npm run test

# íƒ€ì… ì²´í¬
npm run type-check

# ë¦°íŠ¸
npm run lint

# E2E í…ŒìŠ¤íŠ¸
npm run test:e2e
```

### 6.2 ì˜¤ë¥˜ ë¡œê·¸ ê³µìœ  ê·œì¹™

ì˜¤ë¥˜ ë°œìƒ ì‹œ AIì—ê²Œ ì „ë‹¬í•  ì •ë³´:

1. ì „ì²´ ì—ëŸ¬ ë©”ì‹œì§€
2. ê´€ë ¨ ì½”ë“œ ìŠ¤ë‹ˆí«
3. ì¬í˜„ ë‹¨ê³„
4. ì´ë¯¸ ì‹œë„í•œ í•´ê²°ì±…

**ì˜ˆì‹œ:**
```
## ì—ëŸ¬
TypeError: Cannot read property 'id' of undefined

## ì½”ë“œ
const studentId = student.id;  // line 42 in AttendanceCard.tsx

## ì¬í˜„
1. ë¡œê·¸ì¸í•˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ
2. /attendance í˜ì´ì§€ ì ‘ê·¼

## ì‹œë„í•œ ê²ƒ
- studentê°€ undefinedì¸ì§€ í™•ì¸ â†’ ë§ìŒ
- Optional chaining ì‚¬ìš© â†’ ì—¬ì „íˆ ì—ëŸ¬
```

---

## 7. Git ì›Œí¬í”Œë¡œìš°

### 7.1 ë¸Œëœì¹˜ ì „ëµ

```
main          # í”„ë¡œë•ì…˜
â”œâ”€â”€ develop   # ê°œë°œ í†µí•©
â”‚   â”œâ”€â”€ feature/feat-1-attendance
â”‚   â”œâ”€â”€ feature/feat-2-profile
â”‚   â”œâ”€â”€ feature/feat-3-visitation
â”‚   â””â”€â”€ fix/attendance-bug
```

### 7.2 ì»¤ë°‹ ë©”ì‹œì§€

```
<type>(<scope>): <subject>

<body>
```

**íƒ€ì…:**
- `feat`: ìƒˆ ê¸°ëŠ¥
- `fix`: ë²„ê·¸ ìˆ˜ì •
- `refactor`: ë¦¬íŒ©í† ë§
- `docs`: ë¬¸ì„œ
- `test`: í…ŒìŠ¤íŠ¸
- `chore`: ê¸°íƒ€

**ì˜ˆì‹œ:**
```
feat(attendance): ì¶œì„ ì²´í¬ ê¸°ëŠ¥ êµ¬í˜„

- í•™ìƒ ì¹´ë“œ í„°ì¹˜ë¡œ ì¶œì„ ì²˜ë¦¬
- Optimistic Update ì ìš©
- FEAT-1 êµ¬í˜„ ì™„ë£Œ
```

---

## 8. ì½”ë“œ í’ˆì§ˆ ë„êµ¬

### 8.1 í•„ìˆ˜ ì„¤ì •

| ë„êµ¬ | í”„ë¡ íŠ¸ì—”ë“œ | ì„¤ì • íŒŒì¼ |
|------|-----------|----------|
| ë¦°í„° | ESLint | `.eslintrc.json` |
| í¬ë§¤í„° | Prettier | `.prettierrc` |
| íƒ€ì… ì²´í¬ | TypeScript | `tsconfig.json` |

### 8.2 Pre-commit í›…

```json
// package.json
{
  "scripts": {
    "lint": "eslint . --ext .ts,.tsx",
    "format": "prettier --write .",
    "type-check": "tsc --noEmit"
  },
  "husky": {
    "hooks": {
      "pre-commit": "npm run lint && npm run type-check"
    }
  }
}
```

---

## 9. í•œêµ­ì–´ UI í…ìŠ¤íŠ¸ ê·œì¹™

### 9.1 ìš©ì–´ í†µì¼

| ì˜ì–´ | í•œêµ­ì–´ | ì‚¬ìš©ì²˜ |
|------|--------|--------|
| Student | í•™ìƒ | ëª¨ë“  UI í…ìŠ¤íŠ¸ |
| Class | ë°˜ | ëª¨ë“  UI í…ìŠ¤íŠ¸ |
| Visitation | ì‹¬ë°© | ëª¨ë“  UI í…ìŠ¤íŠ¸ |
| Teacher | êµì‚¬ | ëª¨ë“  UI í…ìŠ¤íŠ¸ |
| Attendance | ì¶œì„ | ëª¨ë“  UI í…ìŠ¤íŠ¸ |

### 9.2 ë§íˆ¬

- **í•´ìš”ì²´ ì‚¬ìš©**: "ì¶œì„ ì²´í¬í•˜ì„¸ìš”", "ì‹¬ë°© ê¸°ë¡í•˜ì„¸ìš”"
- **ê²©ë ¤í•˜ëŠ” í†¤**: "ì˜¤ëŠ˜ ì¶œì„ ì²´í¬ ì™„ë£Œ! ğŸ‰"
- **ê¸ˆì§€**: ë²ˆì—­ì²´, ë”±ë”±í•œ ê³µì‹ ìš©ì–´

### 9.3 ì½”ë“œ ì˜ˆì‹œ

```tsx
// âœ… ì¢‹ì€ ì˜ˆ
<Button>ì¶œì„ ì²´í¬í•˜ê¸°</Button>
<p>ì˜¤ëŠ˜ ì¶œì„ ì²´í¬ ì™„ë£Œ! ğŸ‰</p>

// âŒ ë‚˜ìœ ì˜ˆ
<Button>Check Attendance</Button>
<p>Attendance has been recorded.</p>
```

---

## 10. Supabase ì‚¬ìš© ê·œì¹™

### 10.1 RLS ì •ì±… í™•ì¸

ëª¨ë“  ì¿¼ë¦¬ ì‘ì„± ì‹œ RLS ì •ì±…ì„ í™•ì¸:

```typescript
// âœ… ì¢‹ì€ ì˜ˆ - RLS ì •ì±… í™•ì¸
const { data, error } = await supabase
  .from('attendance_logs')
  .select('*')
  .eq('class_id', classId); // RLS ì •ì±…ìœ¼ë¡œ ìë™ í•„í„°ë§

// âŒ ë‚˜ìœ ì˜ˆ - RLS ë¬´ì‹œ
const { data, error } = await supabase
  .from('attendance_logs')
  .select('*'); // ëª¨ë“  ë°ì´í„° ì¡°íšŒ ì‹œë„ (RLSë¡œ ì°¨ë‹¨ë¨)
```

### 10.2 Optimistic Update

ì¶œì„ ì²´í¬ ë“± ì¦‰ê°ì ì¸ UI ë°˜ì‘ì´ í•„ìš”í•œ ê²½ìš°:

```typescript
// Optimistic Update ì˜ˆì‹œ
const mutation = useMutation({
  mutationFn: async (studentId: string) => {
    return await supabase
      .from('attendance_logs')
      .insert({ student_id: studentId, ... });
  },
  onMutate: async (studentId) => {
    // ì¦‰ì‹œ UI ì—…ë°ì´íŠ¸
    queryClient.setQueryData(['attendance'], (old) => {
      return old.map(s => s.id === studentId ? { ...s, status: 'present' } : s);
    });
  },
  onError: (err, studentId, context) => {
    // ì—ëŸ¬ ì‹œ ë¡¤ë°±
    queryClient.setQueryData(['attendance'], context.previousData);
  }
});
```

---

## Decision Log ì°¸ì¡°

- **D-CODE-01**: í”„ë¡œì íŠ¸ êµ¬ì¡° - Next.js App Router ê¸°ë°˜
- **D-CODE-02**: ë„¤ì´ë° - PascalCase (ì»´í¬ë„ŒíŠ¸), camelCase (í•¨ìˆ˜)
- **D-CODE-03**: ë³´ì•ˆ - RLS ì •ì±…ìœ¼ë¡œ DB ë ˆë²¨ ë³´ì•ˆ ê°•ì œ
- **D-CODE-04**: í…ŒìŠ¤íŠ¸ - Contract-First TDD ë°©ì‹
- **D-CODE-05**: í•œêµ­ì–´ UI - í•´ìš”ì²´, ê²©ë ¤í•˜ëŠ” í†¤
