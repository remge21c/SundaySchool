# 데이터 입력 가이드

> 프로덕션 환경에 반(Class)과 학생 데이터를 입력하는 방법

---

## 데이터 입력 방법

### 방법 1: Supabase 대시보드에서 수동 입력 (권장)

파일럿 단계에서는 수동 입력을 권장합니다. 데이터량이 많지 않으므로 정확하고 안전합니다.

### 방법 2: 스크립트를 사용한 일괄 입력 (테스트 데이터)

테스트 데이터를 빠르게 생성하려면 스크립트를 사용할 수 있습니다.

---

## 방법 1: 수동 입력 (Supabase 대시보드)

### 1단계: 담임 교사 ID 확인

반을 생성하기 전에 담임 교사 ID가 필요합니다.

1. Supabase 대시보드 → **Table Editor** → **profiles**
2. 담임 교사로 지정할 사용자 찾기 (예: `airemge@gmail.com`)
3. 해당 사용자의 **id** (UUID) 복사

### 2단계: 반(Class) 데이터 입력

1. Supabase 대시보드 → **Table Editor** → **classes**
2. **Insert row** 클릭
3. 다음 정보 입력:
   - **name**: 반 이름 (예: "1반", "사랑반")
   - **department**: 부서 (예: "유년부", "초등부", "중등부", "고등부")
   - **year**: 학년도 (예: 2026)
   - **main_teacher_id**: 담임 교사 UUID (1단계에서 복사한 값)
4. **Save** 클릭

**예시:**
```
name: "1반"
department: "유년부"
year: 2026
main_teacher_id: (airemge@gmail.com의 UUID)
```

### 3단계: 학생 데이터 입력

1. Supabase 대시보드 → **Table Editor** → **students**
2. **Insert row** 클릭
3. 다음 정보 입력:
   - **name**: 학생 이름 (필수)
   - **grade**: 학년 (필수, 숫자)
   - **birthday**: 생년월일 (선택, YYYY-MM-DD 형식)
   - **gender**: 성별 (선택, 'M' 또는 'F')
   - **parent_contact**: 보호자 연락처 (필수)
   - **address**: 주소 (선택)
   - **school_name**: 학교명 (선택)
   - **class_id**: 반 ID (필수, classes 테이블에서 확인)
   - **allergies**: 알레르기 정보 (선택, JSON 형식)
   - **is_active**: 활성 여부 (기본값: true)
4. **Save** 클릭

**알레르기 정보 입력 (JSON 형식):**
```json
{
  "food": ["우유", "계란"],
  "medicine": [],
  "other": "없음"
}
```

---

## 방법 2: 스크립트를 사용한 테스트 데이터 생성

테스트 데이터를 빠르게 생성하려면:

```bash
npm run seed-test-data
```

**주의**: 이 스크립트는 테스트 데이터를 생성합니다. 실제 데이터를 입력하려면 방법 1을 사용하세요.

---

## 데이터 입력 순서

중요: 다음 순서를 지켜야 합니다:

1. ✅ **교사 계정 생성** (이미 완료: `airemge@gmail.com`)
2. ✅ **프로필 생성** (이미 완료)
3. ⏳ **반(Class) 데이터 입력** ← 현재 단계
4. ⏳ **학생 데이터 입력** ← 다음 단계

**이유**: 학생 데이터는 반 ID(`class_id`)를 필요로 하기 때문입니다.

---

## 빠른 입력 예시

### 반 데이터 예시

| name | department | year | main_teacher_id |
|------|------------|------|-----------------|
| 1반 | 유년부 | 2026 | (airemge@gmail.com의 UUID) |
| 2반 | 유년부 | 2026 | (airemge@gmail.com의 UUID) |
| 1반 | 초등부 | 2026 | (airemge@gmail.com의 UUID) |

### 학생 데이터 예시

| name | grade | class_id | parent_contact |
|------|-------|----------|----------------|
| 홍길동 | 1 | (1반 UUID) | 010-1234-5678 |
| 김영희 | 1 | (1반 UUID) | 010-2345-6789 |

---

## 데이터 검증

입력 후 확인:

1. **반 데이터 확인**:
   - 출석 체크 페이지에서 반이 표시되는지 확인
   - 반 선택 트리에서 확인

2. **학생 데이터 확인**:
   - 출석 체크 페이지에서 반 선택 후 학생 목록 확인
   - 학생 이름이 올바르게 표시되는지 확인

---

## 문제 해결

### 외래 키 제약 오류

- **오류**: `foreign key constraint fails`
- **원인**: 참조하는 ID가 존재하지 않음
- **해결**: 
  - `class_id`: classes 테이블에 반이 존재하는지 확인
  - `main_teacher_id`: profiles 테이블에 교사가 존재하는지 확인

### 필수 필드 누락

- **오류**: `NOT NULL constraint failed`
- **원인**: 필수 필드를 입력하지 않음
- **해결**: 모든 필수 필드 입력 확인

---

## 다음 단계

데이터 입력 완료 후:
1. 웹 애플리케이션에서 확인
2. 출석 체크 기능 테스트
3. 학생 프로필 확인
