# 학생 정보 수정 기능 테스트 결과

> 학생 정보 수정 기능 테스트 결과 기록

**테스트 일시**: 2026-01-13  
**배포 URL**: https://sunday-school-eta.vercel.app/  
**계정 정보**: airemge@gmail.com / ddhqtus1

---

## 사전 준비 확인

### RLS 정책 확인

- [ ] Supabase 대시보드에서 `students` 테이블의 UPDATE 정책 확인
- [ ] `Teachers can update their class students` 정책이 있는지 확인
- [ ] 정책이 없다면 `supabase/migrations/004_add_student_update_policy.sql` 실행

**정책 추가 SQL**:
```sql
DROP POLICY IF EXISTS "Teachers can update their class students" ON students;

CREATE POLICY "Teachers can update their class students"
ON students FOR UPDATE
TO authenticated
USING (
  class_id IN (
    SELECT id FROM classes
    WHERE main_teacher_id = auth.uid()
  )
  OR public.user_role() = 'admin'
)
WITH CHECK (
  class_id IN (
    SELECT id FROM classes
    WHERE main_teacher_id = auth.uid()
  )
  OR public.user_role() = 'admin'
);
```

---

## 테스트 체크리스트

### ✅ 1. 학생 프로필 페이지 접속

**단계**:
1. https://sunday-school-eta.vercel.app/ 접속
2. 로그인 (airemge@gmail.com / ddhqtus1)
3. **학생 관리** 메뉴 클릭 또는 `/students` 페이지 접속
4. 학생 목록에서 학생 한 명 클릭

**결과**:
- [ ] 학생 프로필 페이지가 정상적으로 로드됨
- [ ] 학생 기본 정보가 표시됨 (이름, 학년, 생년월일 등)
- [ ] "기본 정보" 카드에 **"정보 수정"** 버튼이 표시됨

**비고**: 
- 테스트한 학생 이름: _______________
- 테스트한 학생 ID: _______________

---

### ✅ 2. "정보 수정" 버튼 클릭

**단계**:
1. "기본 정보" 카드 헤더의 **"정보 수정"** 버튼 클릭

**결과**:
- [X] 모달 창이 열림
- [X] 모달 제목: "학생 정보 수정"
- [X] 현재 학생 정보가 입력 필드에 채워져 있음
  - [X] 이름
  - [X] 학년
  - [X] 생년월일
  - [X] 성별
  - [X] 학교명
  - [X] 보호자 연락처
  - [X] 주소

**비고**: 
- 모달이 정상적으로 열렸는지: [✅/❌]
- 모든 필드가 채워져 있는지: [✅/❌]

---

### ✅ 3. 정보 수정 후 저장

**단계**:
1. 모달에서 정보 수정 (예: 이름 변경)
2. **"저장"** 버튼 클릭

**수정한 내용**:
- 이름: _______________ → _______________
- 학년: _______________ → _______________
- 기타: _______________

**결과**:
- [X] 저장 버튼 클릭 시 "저장 중..." 표시 (로딩 상태)
- [X] 저장 성공 시 모달이 자동으로 닫힘
- [X] 에러가 발생하면 에러 메시지가 표시됨

**에러 발생 여부**:
- [X] 에러 없음
- [X] 에러 발생: _______________

---

### ✅ 4. 데이터가 정상적으로 저장되는지 확인

**단계**:
1. 모달이 닫힌 후 학생 프로필 페이지 확인
2. 수정한 정보가 즉시 반영되었는지 확인

**결과**:
- [X] 수정한 정보가 프로필 페이지에 즉시 표시됨
- [X] TanStack Query가 자동으로 데이터를 새로고침함

**확인 내용**:
- 이름 변경 확인: [✅/❌]
- 학년 변경 확인: [✅/❌]
- 기타 변경 확인: [✅/❌]

---

### ✅ 5. 페이지 새로고침 후 변경사항이 반영되는지 확인

**단계**:
1. 브라우저 새로고침 (F5 또는 Ctrl+R)
2. 학생 프로필 페이지가 다시 로드됨
3. 수정한 정보가 여전히 표시되는지 확인

**결과**:
- [X] 새로고침 후에도 수정한 정보가 유지됨
- [X] 데이터베이스에 정상적으로 저장되었음을 확인

**확인 내용**:
- 이름 유지 확인: [✅/❌]
- 학년 유지 확인: [✅/❌]
- 기타 정보 유지 확인: [✅/❌]

---

## 추가 테스트

### 필수 필드 검증 테스트

#### 이름 필드 검증
- [X] 이름 필드를 비우고 저장 시도
- [X] "이름을 입력해주세요." 에러 메시지 표시 확인

#### 학년 필드 검증
- [X] 학년을 0으로 입력하고 저장 시도
- [X] 학년을 13 이상으로 입력하고 저장 시도
- [X] "학년을 올바르게 입력해주세요. (1-12)" 에러 메시지 표시 확인

#### 보호자 연락처 필드 검증
- [X] 보호자 연락처를 비우고 저장 시도
- [X] "보호자 연락처를 입력해주세요." 에러 메시지 표시 확인

### 선택 필드 테스트

- [X] 생년월일 수정 테스트
- [X] 성별 수정 테스트
- [X] 학교명 수정 테스트
- [X] 주소 수정 테스트

---

## 발견된 문제

### 문제 1: (문제 제목)

**발견 일시**: YYYY-MM-DD HH:MM  
**페이지**: (페이지 URL)  
**증상**: (문제 설명)  
**재현 방법**: (재현 단계)  
**우선순위**: (높음/중간/낮음)  
**상태**: (미해결/해결 중/해결 완료)

---

## 테스트 결과 요약

### 전체 결과

- **기본 기능 테스트**: [✅ 통과 / ❌ 실패]
- **필수 필드 검증**: [✅ 통과 / ❌ 실패]
- **선택 필드 테스트**: [✅ 통과 / ❌ 실패]

### 주요 발견 사항

1. _______________
2. _______________
3. _______________

### 개선 제안

1. _______________
2. _______________
3. _______________

---

## 테스트 완료 확인

- [X] 모든 기본 기능 테스트 완료
- [X] 필수 필드 검증 테스트 완료
- [X] 선택 필드 테스트 완료
- [X] 발견된 문제 기록 완료
- [X] 테스트 결과 요약 작성 완료

**테스트 완료 일시**: _______________

**테스터**: _______________

---

## 참고

- **테스트 가이드**: `docs/student-edit-test-guide.md`
- **RLS 정책 가이드**: `docs/student-update-policy-fix.md`
- **기능 계획**: `docs/student-edit-feature-plan.md`
