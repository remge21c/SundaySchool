# 학생 정보 수정 기능 테스트 가이드

> 학생 정보 수정 기능 테스트 체크리스트

**테스트 일시**: 2026-01-13  
**배포 URL**: https://sunday-school-eta.vercel.app/  
**계정 정보**: airemge@gmail.com / ddhqtus1

---

## 사전 준비

### 1. RLS 정책 확인

**중요**: 학생 정보 수정이 작동하려면 Supabase에서 UPDATE 정책이 추가되어 있어야 합니다.

**확인 방법**:
1. Supabase 대시보드 → **Authentication** → **Policies**
2. `students` 테이블 선택
3. `Teachers can update their class students` 정책이 있는지 확인

**정책이 없다면**:
- `supabase/migrations/004_add_student_update_policy.sql` 파일의 SQL을 Supabase SQL Editor에서 실행

---

## 테스트 체크리스트

### ✅ 1. 학생 프로필 페이지 접속

**단계**:
1. https://sunday-school-eta.vercel.app/ 접속
2. 로그인 (airemge@gmail.com / ddhqtus1)
3. **학생 관리** 메뉴 클릭 또는 `/students` 페이지 접속
4. 학생 목록에서 학생 한 명 클릭

**예상 결과**:
- [ ] 학생 프로필 페이지가 정상적으로 로드됨
- [ ] 학생 기본 정보가 표시됨 (이름, 학년, 생년월일 등)
- [ ] "기본 정보" 카드에 **"정보 수정"** 버튼이 표시됨

---

### ✅ 2. "정보 수정" 버튼 클릭

**단계**:
1. "기본 정보" 카드 헤더의 **"정보 수정"** 버튼 클릭

**예상 결과**:
- [ ] 모달 창이 열림
- [ ] 모달 제목: "학생 정보 수정"
- [ ] 현재 학생 정보가 입력 필드에 채워져 있음
  - 이름
  - 학년
  - 생년월일
  - 성별
  - 학교명
  - 보호자 연락처
  - 주소

---

### ✅ 3. 정보 수정 후 저장

**단계**:
1. 모달에서 정보 수정 (예: 이름 변경)
2. **"저장"** 버튼 클릭

**예상 결과**:
- [ ] 저장 버튼 클릭 시 "저장 중..." 표시 (로딩 상태)
- [ ] 저장 성공 시 모달이 자동으로 닫힘
- [ ] 에러가 발생하면 에러 메시지가 표시됨

**주의사항**:
- RLS 정책이 없다면 "권한 없음" 또는 "업데이트 실패" 에러가 발생할 수 있음
- 이 경우 `004_add_student_update_policy.sql` SQL을 실행해야 함

---

### ✅ 4. 데이터가 정상적으로 저장되는지 확인

**단계**:
1. 모달이 닫힌 후 학생 프로필 페이지 확인
2. 수정한 정보가 즉시 반영되었는지 확인

**예상 결과**:
- [ ] 수정한 정보가 프로필 페이지에 즉시 표시됨
- [ ] TanStack Query가 자동으로 데이터를 새로고침함

**확인 방법**:
- 이름을 변경했다면 변경된 이름이 표시되어야 함
- 학년을 변경했다면 변경된 학년이 표시되어야 함

---

### ✅ 5. 페이지 새로고침 후 변경사항이 반영되는지 확인

**단계**:
1. 브라우저 새로고침 (F5 또는 Ctrl+R)
2. 학생 프로필 페이지가 다시 로드됨
3. 수정한 정보가 여전히 표시되는지 확인

**예상 결과**:
- [ ] 새로고침 후에도 수정한 정보가 유지됨
- [ ] 데이터베이스에 정상적으로 저장되었음을 확인

---

## 추가 테스트

### 필수 필드 검증 테스트

1. **이름 필드 비우기**:
   - 이름 필드를 비우고 저장 시도
   - 예상: "이름을 입력해주세요." 에러 메시지 표시

2. **학년 필드 검증**:
   - 학년을 0 또는 13 이상으로 입력
   - 예상: "학년을 올바르게 입력해주세요. (1-12)" 에러 메시지 표시

3. **보호자 연락처 필드 비우기**:
   - 보호자 연락처를 비우고 저장 시도
   - 예상: "보호자 연락처를 입력해주세요." 에러 메시지 표시

### 선택 필드 테스트

1. **생년월일 수정**:
   - 생년월일을 변경하고 저장
   - 예상: 정상적으로 저장됨

2. **성별 수정**:
   - 성별을 변경하고 저장
   - 예상: 정상적으로 저장됨

3. **학교명 수정**:
   - 학교명을 변경하고 저장
   - 예상: 정상적으로 저장됨

4. **주소 수정**:
   - 주소를 변경하고 저장
   - 예상: 정상적으로 저장됨

---

## 문제 해결

### 문제 1: "권한 없음" 또는 "업데이트 실패" 에러

**원인**: RLS 정책이 없음

**해결**:
1. Supabase 대시보드 → SQL Editor
2. `supabase/migrations/004_add_student_update_policy.sql` 파일 내용 실행

### 문제 2: 모달이 열리지 않음

**원인**: JavaScript 에러 또는 컴포넌트 로딩 실패

**해결**:
1. 브라우저 개발자 도구(F12) → Console 탭 확인
2. 에러 메시지 확인
3. 페이지 새로고침

### 문제 3: 저장 후 데이터가 반영되지 않음

**원인**: 쿼리 무효화 실패 또는 RLS 정책 문제

**해결**:
1. 페이지 새로고침
2. RLS 정책 확인
3. 브라우저 개발자 도구 → Network 탭에서 API 요청 확인

---

## 테스트 결과 기록

테스트 완료 후 아래 형식으로 결과를 기록해 주세요:

```
### 학생 정보 수정 테스트 결과

**테스트 일시**: 2026-01-13
**테스터**: [이름]

#### 기본 기능 테스트
- [✅/❌] 학생 프로필 페이지 접속
- [✅/❌] "정보 수정" 버튼 클릭
- [✅/❌] 정보 수정 후 저장
- [✅/❌] 데이터가 정상적으로 저장되는지 확인
- [✅/❌] 페이지 새로고침 후 변경사항이 반영되는지 확인

#### 필수 필드 검증 테스트
- [✅/❌] 이름 필드 검증
- [✅/❌] 학년 필드 검증
- [✅/❌] 보호자 연락처 필드 검증

#### 선택 필드 테스트
- [✅/❌] 생년월일 수정
- [✅/❌] 성별 수정
- [✅/❌] 학교명 수정
- [✅/❌] 주소 수정

#### 발견된 문제
- [문제 설명]

#### 추가 의견
- [의견]
```

---

## 참고

- **RLS 정책 가이드**: `docs/student-update-policy-fix.md`
- **기능 계획**: `docs/student-edit-feature-plan.md`
- **배포 URL**: https://sunday-school-eta.vercel.app/
